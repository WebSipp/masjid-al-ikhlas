<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Display Digital Masjid Baiturrahman STMIK Tazkia</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700;800&family=Open+Sans:wght@400;600&family=Amiri:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-dark: #1A4D8C;
            --primary-light: #5D8DC0;
            --accent-blue: #2E77BB;
            --text-dark: #2C3E50;
            --text-light: #F8F9FA;
            --bg-white: #FFFFFF;
            --bg-light: #F0F4F8;
            --shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            --glass-bg: rgba(255, 255, 255, 0.85);
            --friday-gold: #D4AF37;
            --friday-cream: #FFF8E1;
            --friday-dark: #8B6B3D;
            --friday-gradient: linear-gradient(135deg, #D4AF37 0%, #8B6B3D 100%);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Open Sans', sans-serif;
            background: linear-gradient(135deg, #F0F4F8 0%, #E3EAF2 100%);
            color: var(--text-dark);
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            transition: background 0.5s ease;
        }
        
        body.friday-mode {
            background: linear-gradient(135deg, #FFF8E1 0%, #FFECB3 100%);
            --primary-dark: #8B6B3D;
            --accent-blue: #D4AF37;
            --text-dark: #5D4037;
        }
        
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 30px;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
            position: relative;
            z-index: 10;
            min-height: 80px;
            flex-shrink: 0;
            transition: all 0.5s ease;
        }
        
        .friday-mode .header {
            background: rgba(255, 248, 225, 0.95);
            border-bottom: 2px solid var(--friday-gold);
        }
        
        .date-section {
            display: flex;
            flex-direction: column;
        }
        
        .hijri-date {
            font-size: 1.4rem;
            color: var(--primary-dark);
            font-weight: 700;
            margin-bottom: 4px;
            letter-spacing: 0.5px;
        }
        
        .gregorian-date {
            font-size: 1.1rem;
            color: var(--text-dark);
            font-weight: 600;
            opacity: 0.9;
        }
        
        .masjid-section {
            text-align: right;
        }
        
        .masjid-name {
            font-family: 'Montserrat', sans-serif;
            font-weight: 800;
            font-size: 2rem;
            color: var(--primary-dark);
            line-height: 1.1;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            letter-spacing: -0.5px;
        }
        
        .friday-mode .masjid-name {
            color: var(--friday-dark);
            text-shadow: 0 2px 8px rgba(212, 175, 55, 0.3);
        }
        
        .masjid-address {
            font-size: 0.9rem;
            color: var(--text-dark);
            margin-top: 3px;
            font-weight: 500;
            opacity: 0.85;
        }
        
        .friday-notification {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            background: var(--friday-gradient);
            color: white;
            text-align: center;
            padding: 15px;
            font-weight: 600;
            z-index: 1000;
            transform: translateY(-100%);
            transition: transform 0.5s ease;
            font-family: 'Montserrat', sans-serif;
            font-size: 1.2rem;
        }
        
        .friday-notification.show {
            transform: translateY(0);
        }
        
        .friday-countdown {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            color: white;
            text-align: center;
            padding: 20px;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        
        .friday-countdown.show {
            opacity: 1;
            visibility: visible;
        }
        
        .friday-countdown h2 {
            font-family: 'Montserrat', sans-serif;
            font-size: 3rem;
            margin-bottom: 10px;
            color: var(--friday-gold);
        }
        
        .friday-countdown .countdown {
            font-family: 'Montserrat', sans-serif;
            font-size: 4rem;
            font-weight: 800;
            color: white;
            margin: 20px 0;
        }
        
        .friday-countdown p {
            font-size: 1.3rem;
            max-width: 600px;
            line-height: 1.6;
            color: #ddd;
        }
        
        .main-container {
            display: flex;
            flex: 1;
            padding: 15px 20px;
            gap: 20px;
            min-height: 0;
            overflow: hidden;
        }
        
        .sidebar-left {
            flex: 0 0 35%;
            display: flex;
            flex-direction: column;
            gap: 15px;
            min-height: 0;
            height: 100%;
        }
        
        .timer-section {
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: var(--shadow);
            padding: 20px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.9);
            min-height: 200px;
            transition: all 0.5s ease;
        }
        
        .friday-mode .timer-section {
            background: rgba(255, 248, 225, 0.9);
            border: 2px solid var(--friday-gold);
        }
        
        .clock-container {
            margin-bottom: 20px;
        }
        
        .digital-clock {
            font-family: 'Montserrat', sans-serif;
            font-size: 4rem;
            font-weight: 800;
            color: var(--primary-dark);
            line-height: 1;
            margin-bottom: 8px;
            letter-spacing: 2px;
            text-shadow: 0 2px 10px rgba(26, 77, 140, 0.2);
        }
        
        .friday-mode .digital-clock {
            color: var(--friday-dark);
            text-shadow: 0 2px 15px rgba(212, 175, 55, 0.4);
        }
        
        .blink {
            animation: blink 1s infinite;
        }
        
        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }
        
        .timezone {
            font-size: 1.2rem;
            color: var(--primary-light);
            font-weight: 600;
            margin-top: 5px;
            opacity: 0.9;
        }
        
        .friday-mode .timezone {
            color: var(--friday-gold);
        }
        
        .countdown-container {
            background: linear-gradient(135deg, var(--primary-dark) 0%, var(--accent-blue) 100%);
            border-radius: 16px;
            padding: 15px;
            box-shadow: 0 10px 20px rgba(46, 119, 187, 0.3);
            min-height: 90px;
            transition: all 0.5s ease;
        }
        
        .friday-mode .countdown-container {
            background: var(--friday-gradient);
            box-shadow: 0 10px 20px rgba(212, 175, 55, 0.4);
        }
        
        .next-prayer-name {
            font-family: 'Montserrat', sans-serif;
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--text-light);
            margin-bottom: 8px;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
        }
        
        .countdown-timer {
            font-family: 'Montserrat', sans-serif;
            font-size: 2.2rem;
            font-weight: 800;
            color: var(--text-light);
            letter-spacing: 1px;
            text-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
        }
        
        .wisdom-section {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 15px;
            min-height: 150px;
            overflow: visible;
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: var(--shadow);
            border: 1px solid rgba(255, 255, 255, 0.9);
            transition: all 0.5s ease;
        }
        
        .friday-mode .wisdom-section {
            background: rgba(255, 248, 225, 0.9);
            border: 2px solid var(--friday-gold);
        }
        
        .wisdom-content {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            opacity: 1;
            transition: opacity 0.8s ease-in-out;
            text-align: center;
            width: 100%;
            height: 100%;
        }
        
        .wisdom-text {
            font-size: 1.15rem;
            line-height: 1.7;
            color: var(--text-dark);
            font-style: italic;
            margin-bottom: 12px;
            padding: 0 10px;
            font-weight: 500;
            max-width: 95%;
            font-family: 'Amiri', serif;
        }
        
        .friday-mode .wisdom-text {
            color: var(--friday-dark);
            font-weight: 600;
        }
        
        .wisdom-reference {
            font-size: 0.95rem;
            color: var(--primary-dark);
            font-weight: 700;
            font-style: normal;
            padding: 6px 15px;
            background: rgba(26, 77, 140, 0.08);
            border-radius: 50px;
            display: inline-block;
        }
        
        .friday-mode .wisdom-reference {
            color: var(--friday-dark);
            background: rgba(212, 175, 55, 0.15);
        }
        
        .sidebar-right {
            flex: 1;
            background-color: #e6e6e6;
            border-radius: 20px;
            overflow: hidden;
            position: relative;
            min-height: 0;
            box-shadow: var(--shadow);
            transition: all 0.5s ease;
        }
        
        .friday-mode .sidebar-right {
            border: 2px solid var(--friday-gold);
        }
        
        .friday-content {
            display: none;
            width: 100%;
            height: 100%;
            padding: 20px;
            overflow-y: auto;
        }
        
        .friday-mode .friday-content {
            display: block;
        }
        
        .friday-mode .wallpaper-slider {
            display: none;
        }
        
        .jumat-schedule {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .jumat-schedule h3 {
            color: var(--friday-dark);
            font-family: 'Montserrat', sans-serif;
            margin-bottom: 15px;
            text-align: center;
            font-size: 1.4rem;
        }
        
        .jumat-times {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }
        
        .jumat-time-item {
            text-align: center;
            padding: 10px;
            background: rgba(212, 175, 55, 0.1);
            border-radius: 10px;
            border: 1px solid rgba(212, 175, 55, 0.3);
        }
        
        .jumat-time-label {
            font-weight: 600;
            color: var(--friday-dark);
            font-size: 0.9rem;
            margin-bottom: 5px;
        }
        
        .jumat-time-value {
            font-family: 'Montserrat', sans-serif;
            font-weight: 700;
            color: var(--friday-dark);
            font-size: 1.3rem;
        }
        
        .jumat-officers {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .jumat-officers h3 {
            color: var(--friday-dark);
            font-family: 'Montserrat', sans-serif;
            margin-bottom: 15px;
            text-align: center;
            font-size: 1.4rem;
        }
        
        .officers-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }
        
        .officer-item {
            text-align: center;
            padding: 12px;
            background: rgba(212, 175, 55, 0.1);
            border-radius: 10px;
            border: 1px solid rgba(212, 175, 55, 0.3);
        }
        
        .officer-role {
            font-weight: 600;
            color: var(--friday-dark);
            font-size: 0.9rem;
            margin-bottom: 5px;
        }
        
        .officer-name {
            font-weight: 700;
            color: var(--friday-dark);
            font-size: 1.1rem;
        }
        
        .jumat-announcements {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            min-height: 250px;
            position: relative;
            overflow: hidden;
        }
        
        .jumat-announcements h3 {
            color: var(--friday-dark);
            font-family: 'Montserrat', sans-serif;
            margin-bottom: 15px;
            text-align: center;
            font-size: 1.4rem;
        }
        
        .announcement-slide {
            position: absolute;
            top: 60px;
            left: 0;
            width: 100%;
            height: calc(100% - 80px);
            padding: 0 20px;
            opacity: 0;
            transition: opacity 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .announcement-slide.active {
            opacity: 1;
        }
        
        .announcement-slide img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            border-radius: 10px;
        }
        
        .wallpaper-slider {
            width: 100%;
            height: 100%;
            position: relative;
        }
        
        .wallpaper-slide {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            opacity: 0;
            transition: opacity 1.2s ease-in-out;
        }
        
        .wallpaper-slide.active {
            opacity: 1;
        }
        
        .prayer-schedule {
            background: linear-gradient(135deg, var(--primary-dark) 0%, #153a6e 100%);
            border-radius: 20px 20px 0 0;
            padding: 12px 0;
            min-height: 110px;
            box-shadow: 0 -5px 20px rgba(0, 0, 0, 0.1);
            position: relative;
            z-index: 5;
            flex-shrink: 0;
            transition: all 0.5s ease;
        }
        
        .friday-mode .prayer-schedule {
            background: var(--friday-gradient);
        }
        
        .prayer-schedule::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, transparent, var(--accent-blue), transparent);
            animation: shimmer-line 3s infinite linear;
        }
        
        .friday-mode .prayer-schedule::before {
            background: linear-gradient(90deg, transparent, var(--friday-gold), transparent);
        }
        
        @keyframes shimmer-line {
            0% { background-position: -200px 0; }
            100% { background-position: calc(200px + 100%) 0; }
        }
        
        .schedule-title {
            text-align: center;
            color: var(--text-light);
            font-family: 'Montserrat', sans-serif;
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 12px;
            padding: 0 20px;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
            letter-spacing: 1px;
        }
        
        .prayer-grid {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 2px;
            padding: 0 10px;
        }
        
        @media (max-width: 1024px) {
            .prayer-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }
        
        @media (max-width: 768px) {
            .prayer-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        .prayer-item {
            background-color: rgba(255, 255, 255, 0.08);
            padding: 10px 5px;
            text-align: center;
            border-radius: 10px;
            margin: 0 3px;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.05);
            position: relative;
            overflow: hidden;
        }
        
        .prayer-item:hover {
            background-color: rgba(255, 255, 255, 0.12);
            transform: translateY(-2px);
        }
        
        .prayer-item.active {
            background: linear-gradient(135deg, var(--accent-blue) 0%, #3a8ce4 100%);
            transform: scale(1.05);
            box-shadow: 0 8px 20px rgba(46, 119, 187, 0.4);
            z-index: 2;
        }
        
        .friday-mode .prayer-item.active {
            background: linear-gradient(135deg, var(--friday-gold) 0%, #FFD700 100%);
            box-shadow: 0 8px 20px rgba(212, 175, 55, 0.5);
        }
        
        .prayer-item.active::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            animation: shimmer-active 3s infinite;
        }
        
        @keyframes shimmer-active {
            0% { left: -100%; }
            100% { left: 100%; }
        }
        
        .prayer-name {
            font-size: 0.9rem;
            color: var(--text-light);
            font-weight: 600;
            margin-bottom: 6px;
            opacity: 0.9;
        }
        
        .prayer-item.active .prayer-name {
            opacity: 1;
            font-weight: 700;
        }
        
        .prayer-time {
            font-family: 'Montserrat', sans-serif;
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--text-light);
            letter-spacing: 1px;
            position: relative;
            z-index: 1;
        }
        
        .marquee-container {
            background: linear-gradient(90deg, rgba(240, 247, 255, 0.9) 0%, rgba(255, 255, 255, 0.9) 100%);
            padding: 8px 0;
            overflow: hidden;
            border-top: 2px solid var(--primary-light);
            height: 45px;
            position: relative;
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
            flex-shrink: 0;
            transition: all 0.5s ease;
        }
        
        .friday-mode .marquee-container {
            background: linear-gradient(90deg, rgba(255, 248, 225, 0.9) 0%, rgba(255, 255, 255, 0.9) 100%);
            border-top: 2px solid var(--friday-gold);
        }
        
        .marquee-track {
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            width: max-content;
            display: flex;
            align-items: center;
            animation: marquee-very-slow 300s linear infinite;
        }
        
        .friday-mode .marquee-track {
            animation: marquee-very-slow 400s linear infinite;
        }
        
        .adab-item {
            white-space: nowrap;
            padding: 0 60px;
            font-size: 1rem;
            font-weight: 600;
            color: var(--primary-dark);
            display: flex;
            align-items: center;
        }
        
        .friday-mode .adab-item {
            color: var(--friday-dark);
        }
        
        @keyframes marquee-very-slow {
            0% { transform: translateX(100vw); }
            100% { transform: translateX(-100%); }
        }
        
        .adab-item i {
            margin-right: 10px;
            color: var(--accent-blue);
            font-size: 1rem;
        }
        
        .friday-mode .adab-item i {
            color: var(--friday-gold);
        }
        
        .azan-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--primary-dark) 0%, var(--accent-blue) 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9998;
            color: white;
            text-align: center;
            padding: 20px;
            opacity: 0;
            visibility: hidden;
            transition: all 0.5s ease;
        }
        
        .azan-overlay.show {
            opacity: 1;
            visibility: visible;
        }
        
        .azan-overlay h1 {
            font-family: 'Montserrat', sans-serif;
            font-size: 4rem;
            margin-bottom: 20px;
            text-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .azan-countdown {
            font-family: 'Montserrat', sans-serif;
            font-size: 6rem;
            font-weight: 800;
            margin: 20px 0;
            text-shadow: 0 5px 15px rgba(0, 0, 0, 0.4);
            letter-spacing: 5px;
        }
        
        .azan-prayer-name {
            font-size: 2.5rem;
            font-weight: 700;
            margin-top: 20px;
            opacity: 0.9;
        }
        
        .salah-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            color: #666;
            text-align: center;
            opacity: 0;
            visibility: hidden;
            transition: all 0.5s ease;
        }
        
        .salah-overlay.show {
            opacity: 1;
            visibility: visible;
        }
        
        .salah-clock {
            font-family: 'Montserrat', sans-serif;
            font-size: 3rem;
            color: #444;
            margin-bottom: 20px;
            letter-spacing: 3px;
        }
        
        .salah-text {
            font-size: 2rem;
            color: #555;
            font-weight: 600;
        }
        
        .fullscreen-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            color: white;
            text-align: center;
            padding: 20px;
        }
        
        .fullscreen-overlay h2 {
            font-family: 'Montserrat', sans-serif;
            font-size: 2rem;
            margin-bottom: 20px;
            color: var(--accent-blue);
        }
        
        .fullscreen-overlay p {
            font-size: 1.2rem;
            margin-bottom: 30px;
            max-width: 600px;
            line-height: 1.6;
        }
        
        .fullscreen-btn {
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--primary-dark) 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.2rem;
            font-weight: 600;
            border-radius: 50px;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
            font-family: 'Montserrat', sans-serif;
        }
        
        .fullscreen-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 25px rgba(46, 119, 187, 0.4);
        }
        
        /* ========== RESPONSIVE ========== */
        @media (min-width: 1921px) {
            body { font-size: 1.2rem; }
            .header { padding: 25px 50px; min-height: 100px; }
            .hijri-date { font-size: 1.8rem; }
            .gregorian-date { font-size: 1.4rem; }
            .masjid-name { font-size: 2.8rem; }
            .masjid-address { font-size: 1.1rem; }
            .main-container { padding: 20px 30px; gap: 30px; }
            .digital-clock { font-size: 5rem; }
            .timezone { font-size: 1.5rem; }
            .countdown-timer { font-size: 2.5rem; }
            .wisdom-text { font-size: 1.6rem; }
            .wisdom-reference { font-size: 1.2rem; }
            .prayer-schedule { min-height: 130px; }
            .prayer-time { font-size: 1.8rem; }
            .marquee-container { height: 55px; }
            .adab-item { font-size: 1.3rem; }
        }
        
        @media (max-width: 1366px) {
            .digital-clock { font-size: 3.5rem; }
            .countdown-timer { font-size: 2rem; }
            .wisdom-text { font-size: 1.1rem; }
        }
        
        @media (max-width: 1024px) {
            .main-container { flex-direction: column; }
            .sidebar-left { max-height: 380px; }
            .sidebar-right { height: 300px; flex: 1; }
        }
        
        @media (max-width: 768px) {
            .header { flex-direction: column; text-align: center; gap: 10px; padding: 12px 20px; }
            .date-section, .masjid-section { text-align: center; width: 100%; }
            .masjid-name { font-size: 1.6rem; }
            .digital-clock { font-size: 3rem; }
        }
        
        @media (max-width: 480px) {
            .masjid-name { font-size: 1.4rem; }
            .digital-clock { font-size: 2.5rem; }
        }
    </style>
</head>
<body>
    <div class="fullscreen-overlay" id="fullscreen-overlay">
        <h2>Display Digital Masjid Baiturrahman STMIK Tazkia</h2>
        <p>Untuk pengalaman terbaik, tampilan akan dibuka dalam mode layar penuh.</p>
        <button class="fullscreen-btn" id="enter-fullscreen-btn">
            <i class="fas fa-expand"></i> Buka Layar Penuh
        </button>
        <p style="margin-top: 20px; font-size: 0.9rem; opacity: 0.7;">Tekan F11 untuk toggle fullscreen | ESC untuk keluar</p>
    </div>
    
    <div class="friday-notification" id="friday-notification">
        <i class="fas fa-star"></i> MODE JUMAT AKTIF (08:00 - 14:00 WIB) <i class="fas fa-star"></i>
    </div>
    
    <div class="friday-countdown" id="friday-countdown">
        <h2>MODE JUMAT AKAN DIMULAI</h2>
        <div class="countdown" id="friday-mode-countdown">00:59</div>
        <p>Tampilan khusus Jumat dengan jadwal shalat Jumat, pengumuman, dan hadis keutamaan hari Jumat akan segera dimulai.</p>
    </div>
    
    <div class="azan-overlay" id="azan-overlay">
        <h1 id="azan-title">XX DETIK MENUJU AZAN</h1>
        <div class="azan-countdown" id="azan-countdown">30</div>
        <div class="azan-prayer-name" id="azan-prayer-name">MAGHRIB</div>
    </div>
    
    <div class="salah-overlay" id="salah-overlay">
        <div class="salah-clock" id="salah-clock">14:45</div>
        <div class="salah-text" id="salah-text">Shalat MAGHRIB...</div>
    </div>
    
    <header class="header">
        <div class="date-section">
            <div class="hijri-date" id="hijri-date">Loading...</div>
            <div class="gregorian-date" id="gregorian-date">Loading...</div>
        </div>
        
        <div class="masjid-section">
            <h1 class="masjid-name" id="masjid-name">Loading...</h1>
            <p class="masjid-address" id="masjid-address">Loading...</p>
        </div>
    </header>
    
    <div class="main-container">
        <div class="sidebar-left">
            <div class="timer-section">
                <div class="clock-container">
                    <div class="digital-clock" id="digital-clock">00:00</div>
                    <div class="timezone" id="timezone">WIB</div>
                </div>
                
                <div class="countdown-container">
                    <div class="next-prayer-name" id="next-prayer-name">Loading...</div>
                    <div class="countdown-timer" id="countdown-timer">00:00:00</div>
                </div>
            </div>
            
            <div class="wisdom-section">
                <div class="wisdom-content fade-in" id="wisdom-content">
                    <div class="wisdom-text" id="wisdom-text">Loading konten hikmah...</div>
                    <div class="wisdom-reference" id="wisdom-reference">Loading...</div>
                </div>
            </div>
        </div>
        
        <div class="sidebar-right">
            <div class="wallpaper-slider" id="wallpaper-slider">
                <!-- Wallpapers will be loaded dynamically -->
            </div>
            
            <div class="friday-content">
                <div class="jumat-schedule">
                    <h3><i class="fas fa-clock"></i> JADWAL SHALAT JUMAT</h3>
                    <div class="jumat-times">
                        <div class="jumat-time-item">
                            <div class="jumat-time-label">Waktu Khutbah</div>
                            <div class="jumat-time-value" id="khutbah-time">11:30</div>
                        </div>
                        <div class="jumat-time-item">
                            <div class="jumat-time-label">Waktu Iqamah</div>
                            <div class="jumat-time-value" id="iqamah-time">12:00</div>
                        </div>
                    </div>
                </div>
                
                <div class="jumat-officers">
                    <h3><i class="fas fa-users"></i> PETUGAS JUMAT</h3>
                    <div class="officers-grid">
                        <div class="officer-item">
                            <div class="officer-role">Imam</div>
                            <div class="officer-name" id="imam-name">Loading...</div>
                        </div>
                        <div class="officer-item">
                            <div class="officer-role">Khatib</div>
                            <div class="officer-name" id="khatib-name">Loading...</div>
                        </div>
                        <div class="officer-item">
                            <div class="officer-role">Muadzin 1</div>
                            <div class="officer-name" id="muadzin1-name">Loading...</div>
                        </div>
                        <div class="officer-item">
                            <div class="officer-role">Muadzin 2</div>
                            <div class="officer-name" id="muadzin2-name">Loading...</div>
                        </div>
                    </div>
                </div>
                
                <div class="jumat-announcements">
                    <h3><i class="fas fa-bullhorn"></i> PENGUMUMAN</h3>
                    <!-- Announcements will be loaded dynamically -->
                </div>
            </div>
        </div>
    </div>
    
    <footer class="prayer-schedule">
        <div class="schedule-title">JADWAL SHALAT HARI INI</div>
        <div class="prayer-grid" id="prayer-grid">
            <div class="prayer-item"><div class="prayer-name">Subuh</div><div class="prayer-time">--:--</div></div>
            <div class="prayer-item"><div class="prayer-name">Syuruq</div><div class="prayer-time">--:--</div></div>
            <div class="prayer-item"><div class="prayer-name">Dzuhur</div><div class="prayer-time">--:--</div></div>
            <div class="prayer-item"><div class="prayer-name">Ashar</div><div class="prayer-time">--:--</div></div>
            <div class="prayer-item"><div class="prayer-name">Maghrib</div><div class="prayer-time">--:--</div></div>
            <div class="prayer-item"><div class="prayer-name">Isya</div><div class="prayer-time">--:--</div></div>
        </div>
    </footer>
    
    <div class="marquee-container">
        <div class="marquee-track" id="marquee-track">
            <div class="adab-item"><i class="fas fa-door-open"></i> Loading adab Islam...</div>
        </div>
    </div>

    <script>
        // ========================================
        // API CONFIGURATION - âœ… URL BARU!
        // ========================================
        const API_URL = "https://script.google.com/macros/s/AKfycbw266ibZIFB4PdraKuEY_rt0c-w92ih1VDshK4ylzW3Ig1ZzCAMNCvmexw-wM6erE_6/exec";
        
        // URUTAN SHALAT
        const prayerOrder = ["Subuh", "Syuruq", "Dzuhur", "Ashar", "Maghrib", "Isya"];
        
        // VARIABEL GLOBAL
        let configData = {};
        let prayerTimesData = {};
        let wisdomsData = [];
        let fridayWisdomsData = [];
        let adabsNormalData = [];
        let adabsFridayData = [];
        let wallpapersData = [];
        let announcementsData = [];
        let fridayScheduleData = {};
        
        let currentMode = "normal";
        let wisdomIndex = 0;
        let fridayHadithIndex = 0;
        let announcementIndex = 0;
        let wallpaperIndex = 0;
        let audioContext;
        let beepSound;
        let azanPhase = 1;
        let azanTimer;
        let iqamahTimer;
        let salahTimer;
        let currentPrayerName = "";
        let hijriDateString = "";
        let gregorianDateString = "";
        let currentDayName = "";
        let lastApiFetch = 0;
        const API_CACHE_TIME = 60 * 60 * 1000; // 1 jam cache
        let hijriRetryCount = 0;
        const MAX_HIJRI_RETRY = 3;
        
        // ========================================
        // FETCH ALL DATA FROM API
        // ========================================
        async function fetchAllData() {
            try {
                console.log("ðŸ”„ Fetching all data from API...");
                
                // Fetch Config
                const configRes = await fetch(`${API_URL}?path=config`);
                const configResult = await configRes.json();
                
                if (configResult.success) {
                    configData = configResult.data;
                    console.log("âœ… Config loaded:", configData);
                    
                    // Update UI
                    document.getElementById('masjid-name').textContent = configData.masjid_name || 'Masjid';
                    document.getElementById('masjid-address').textContent = configData.masjid_address || '';
                }
                
                // Fetch Wisdoms
                const wisdomsRes = await fetch(`${API_URL}?path=wisdoms`);
                const wisdomsResult = await wisdomsRes.json();
                
                if (wisdomsResult.success) {
                    wisdomsData = wisdomsResult.data.filter(w => w.active);
                    console.log("âœ… Wisdoms loaded:", wisdomsData.length);
                }
                
                // Fetch Friday Wisdoms
                const fridayWisdomsRes = await fetch(`${API_URL}?path=friday-wisdoms`);
                const fridayWisdomsResult = await fridayWisdomsRes.json();
                
                if (fridayWisdomsResult.success) {
                    fridayWisdomsData = fridayWisdomsResult.data.filter(w => w.active);
                    console.log("âœ… Friday wisdoms loaded:", fridayWisdomsData.length);
                }
                
                // Fetch Adabs Normal
                const adabsNormalRes = await fetch(`${API_URL}?path=adabs&type=normal`);
                const adabsNormalResult = await adabsNormalRes.json();
                
                if (adabsNormalResult.success) {
                    adabsNormalData = adabsNormalResult.data.filter(a => a.active);
                    console.log("âœ… Normal adabs loaded:", adabsNormalData.length);
                }
                
                // Fetch Adabs Friday
                const adabsFridayRes = await fetch(`${API_URL}?path=adabs&type=friday`);
                const adabsFridayResult = await adabsFridayRes.json();
                
                if (adabsFridayResult.success) {
                    adabsFridayData = adabsFridayResult.data.filter(a => a.active);
                    console.log("âœ… Friday adabs loaded:", adabsFridayData.length);
                }
                
                // Fetch Friday Schedule
                const scheduleRes = await fetch(`${API_URL}?path=friday-schedule`);
                const scheduleResult = await scheduleRes.json();
                
                if (scheduleResult.success) {
                    fridayScheduleData = scheduleResult.data;
                    console.log("âœ… Friday schedule loaded");
                    
                    // Update UI
                    document.getElementById('khutbah-time').textContent = fridayScheduleData.khutbah_time || '11:30';
                    document.getElementById('iqamah-time').textContent = fridayScheduleData.iqamah_time || '12:00';
                    document.getElementById('imam-name').textContent = fridayScheduleData.imam_name || '-';
                    document.getElementById('khatib-name').textContent = fridayScheduleData.khatib_name || '-';
                    document.getElementById('muadzin1-name').textContent = fridayScheduleData.muadzin1_name || '-';
                    document.getElementById('muadzin2-name').textContent = fridayScheduleData.muadzin2_name || '-';
                }
                
                // Fetch Announcements
                const announcementsRes = await fetch(`${API_URL}?path=announcements`);
                const announcementsResult = await announcementsRes.json();
                
                if (announcementsResult.success) {
                    announcementsData = announcementsResult.data
                        .filter(a => a.active)
                        .sort((a, b) => a.order - b.order);
                    console.log("âœ… Announcements loaded:", announcementsData.length);
                    renderAnnouncements();
                }
                
                // Fetch Wallpapers
                const wallpapersRes = await fetch(`${API_URL}?path=wallpapers`);
                const wallpapersResult = await wallpapersRes.json();
                
                if (wallpapersResult.success) {
                    wallpapersData = wallpapersResult.data
                        .filter(w => w.active)
                        .sort((a, b) => a.order - b.order);
                    console.log("âœ… Wallpapers loaded:", wallpapersData.length);
                    renderWallpapers();
                }
                
                console.log("âœ… All data loaded successfully!");
                lastApiFetch = Date.now();
                
            } catch (error) {
                console.error("âŒ Error fetching data:", error);
            }
        }
        
        // ========================================
        // RENDER FUNCTIONS
        // ========================================
        function renderWallpapers() {
            const container = document.getElementById('wallpaper-slider');
            container.innerHTML = '';
            
            if (wallpapersData.length === 0) {
                // Fallback wallpapers
                wallpapersData = [
                    { image_url: 'https://images.unsplash.com/photo-1548013146-72479768bada?w=1920' },
                    { image_url: 'https://images.unsplash.com/photo-1562774053-701939374585?w=1920' },
                    { image_url: 'https://images.unsplash.com/photo-1545569341-9eb8b30979d9?w=1920' }
                ];
            }
            
            wallpapersData.forEach((wallpaper, index) => {
                const slide = document.createElement('div');
                slide.className = `wallpaper-slide ${index === 0 ? 'active' : ''}`;
                slide.style.backgroundImage = `linear-gradient(rgba(0, 0, 0, 0.25), rgba(0, 0, 0, 0.25)), url('${wallpaper.image_url}')`;
                container.appendChild(slide);
            });
        }
        
        function renderAnnouncements() {
            const container = document.querySelector('.jumat-announcements');
            const title = container.querySelector('h3');
            container.innerHTML = '';
            container.appendChild(title);
            
            if (announcementsData.length === 0) {
                const slide = document.createElement('div');
                slide.className = 'announcement-slide active';
                const div = document.createElement('div');
                div.className = 'announcement-text';
                div.textContent = 'Belum ada pengumuman';
                div.style.fontSize = '1.2rem';
                div.style.color = 'var(--friday-dark)';
                div.style.fontWeight = '600';
                slide.appendChild(div);
                container.appendChild(slide);
                return;
            }
            
            announcementsData.forEach((announcement, index) => {
                const slide = document.createElement('div');
                slide.className = `announcement-slide ${index === 0 ? 'active' : ''}`;
                
                if (announcement.image_url) {
                    const img = document.createElement('img');
                    img.src = announcement.image_url;
                    img.alt = `Pengumuman ${index + 1}`;
                    img.onerror = function() {
                        this.onerror = null;
                        this.src = 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="400" height="300"><rect fill="%23f0f0f0" width="400" height="300"/><text fill="%23999" x="50%" y="50%" text-anchor="middle" dy=".3em">Gambar tidak tersedia</text></svg>';
                    };
                    slide.appendChild(img);
                } else if (announcement.text) {
                    const div = document.createElement('div');
                    div.className = 'announcement-text';
                    div.textContent = announcement.text;
                    div.style.fontSize = '1.2rem';
                    div.style.color = 'var(--friday-dark)';
                    div.style.fontWeight = '600';
                    slide.appendChild(div);
                }
                
                container.appendChild(slide);
            });
        }
        
        function createAdabMarquee() {
            const marqueeTrack = document.getElementById('marquee-track');
            marqueeTrack.innerHTML = '';
            
            const currentAdabs = currentMode === "friday" ? adabsFridayData : adabsNormalData;
            
            if (currentAdabs.length === 0) {
                const adabItem = document.createElement('div');
                adabItem.className = 'adab-item';
                adabItem.innerHTML = '<i class="fas fa-info-circle"></i> Selamat datang di Masjid Baiturrahman STMIK Tazkia';
                marqueeTrack.appendChild(adabItem);
                return;
            }
            
            const sortedAdabs = currentAdabs.sort((a, b) => a.order - b.order);
            
            // Duplicate for seamless loop
            for (let i = 0; i < 2; i++) {
                sortedAdabs.forEach((adab) => {
                    const adabItem = document.createElement('div');
                    adabItem.className = 'adab-item';
                    adabItem.innerHTML = `<i class="${adab.icon}"></i> ${adab.text}`;
                    marqueeTrack.appendChild(adabItem);
                    
                    const space = document.createElement('div');
                    space.style.padding = '0 150px';
                    marqueeTrack.appendChild(space);
                });
            }
            
            const marquee = document.querySelector('.marquee-track');
            const speed = currentMode === "friday" ? 
                (configData.marquee_speed_friday || 400) : 
                (configData.marquee_speed || 300);
            marquee.style.animationDuration = speed + 's';
        }
        
        // ========================================
        // HIJRI DATE - FIXED
        // ========================================
        
        async function fetchHijriDate() {
            try {
                const now = new Date();
                const dateString = formatDateToDDMMYYYY(now);
                
                console.log("ðŸ”„ Fetching Hijri date from backend...");
                
                // Gunakan endpoint backend untuk mendapatkan tanggal Hijriah
                const response = await fetch(`${API_URL}?path=hijri-date&date=${dateString}`);
                const result = await response.json();
                
                if (result.success) {
                    hijriDateString = result.data.hijri;
                    gregorianDateString = result.data.gregorian;
                    
                    document.getElementById('hijri-date').textContent = hijriDateString;
                    document.getElementById('gregorian-date').textContent = gregorianDateString;
                    
                    // Update current day name
                    const gregorianParts = gregorianDateString.split(',');
                    if (gregorianParts.length > 0) {
                        currentDayName = gregorianParts[0].trim();
                    }
                    
                    console.log("âœ… Hijri date updated:", hijriDateString);
                    hijriRetryCount = 0; // Reset retry count on success
                    return true;
                } else {
                    console.error("âŒ Failed to fetch Hijri date:", result.error);
                    return useFallbackHijriDate();
                }
            } catch (error) {
                console.error("âŒ Error fetching Hijri date:", error);
                return useFallbackHijriDate();
            }
        }
        
        function useFallbackHijriDate() {
            console.warn("âš ï¸ Using fallback Hijri date calculator");
            
            const now = new Date();
            
            // Kalkulasi sederhana berdasarkan referensi
            const fallback = getFallbackHijriDate(now);
            
            hijriDateString = fallback.hijri;
            gregorianDateString = fallback.gregorian;
            
            document.getElementById('hijri-date').textContent = hijriDateString;
            document.getElementById('gregorian-date').textContent = gregorianDateString;
            
            const gregorianParts = gregorianDateString.split(',');
            if (gregorianParts.length > 0) {
                currentDayName = gregorianParts[0].trim();
            }
            
            return false;
        }
        
        function getFallbackHijriDate(date) {
            // Tanggal referensi: 1 Januari 2024 = 19 Jumadil Akhir 1445 H
            const referenceDate = new Date(2024, 0, 1);
            const referenceHijriDay = 19;
            const referenceHijriMonth = 5; // Jumadil Akhir (0-indexed: Muharram=0)
            const referenceHijriYear = 1445;
            
            // Selisih hari
            const diffTime = date - referenceDate;
            const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
            
            // Hitung tanggal Hijriah (perkiraan)
            let hijriDay = referenceHijriDay + diffDays;
            let hijriMonth = referenceHijriMonth;
            let hijriYear = referenceHijriYear;
            
            while (hijriDay > 30) {
                hijriDay -= 30;
                hijriMonth++;
                if (hijriMonth > 11) {
                    hijriMonth = 0;
                    hijriYear++;
                }
            }
            
            while (hijriDay < 1) {
                hijriDay += 30;
                hijriMonth--;
                if (hijriMonth < 0) {
                    hijriMonth = 11;
                    hijriYear--;
                }
            }
            
            const monthNames = [
                "Muharram", "Safar", "Rabiul Awal", "Rabiul Akhir",
                "Jumadil Awal", "Jumadil Akhir", "Rajab", "Sya'ban",
                "Ramadan", "Syawal", "Dzulqaidah", "Dzulhijjah"
            ];
            
            const dayNames = [
                "Minggu", "Senin", "Selasa", "Rabu", "Kamis", "Jumat", "Sabtu"
            ];
            
            const gregorianMonthNames = [
                "Januari", "Februari", "Maret", "April", "Mei", "Juni",
                "Juli", "Agustus", "September", "Oktober", "November", "Desember"
            ];
            
            return {
                hijri: `${dayNames[date.getDay()]}, ${hijriDay} ${monthNames[hijriMonth]} ${hijriYear} H`,
                gregorian: `${dayNames[date.getDay()]}, ${date.getDate()} ${gregorianMonthNames[date.getMonth()]} ${date.getFullYear()}`
            };
        }
        
        function formatDateToDDMMYYYY(date) {
            const day = String(date.getDate()).padStart(2, '0');
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const year = date.getFullYear();
            return `${day}-${month}-${year}`;
        }
        
        // ========================================
        // PRAYER TIMES
        // ========================================
        
        async function fetchPrayerTimes() {
            try {
                const now = new Date();
                const dateString = formatDateToDDMMYYYY(now);
                
                const latitude = configData.latitude || -6.59444;
                const longitude = configData.longitude || 106.78917;
                const method = configData.api_method || 11;
                const timezone = configData.timezone || 'Asia/Jakarta';
                
                const apiUrl = `https://api.aladhan.com/v1/timings/${dateString}?latitude=${latitude}&longitude=${longitude}&method=${method}&timezone=${timezone}`;
                
                console.log("ðŸ”„ Fetching prayer times from:", apiUrl);
                
                const response = await fetch(apiUrl);
                const data = await response.json();
                
                if (data.code === 200 && data.data) {
                    console.log("âœ… Prayer times API success!");
                    
                    const timings = data.data.timings;
                    
                    prayerTimesData = {
                        "Subuh": timings.Fajr,
                        "Syuruq": timings.Sunrise,
                        "Dzuhur": timings.Dhuhr,
                        "Ashar": timings.Asr,
                        "Maghrib": timings.Maghrib,
                        "Isya": timings.Isha
                    };
                    
                    updatePrayerScheduleUI();
                    return true;
                } else {
                    console.error("âŒ API Response error:", data);
                    return useFallbackPrayerTimes();
                }
                
            } catch (error) {
                console.error("âŒ Error fetching prayer times:", error);
                return useFallbackPrayerTimes();
            }
        }
        
        function useFallbackPrayerTimes() {
            console.warn("âš ï¸ Using fallback prayer times");
            
            // Default jadwal untuk wilayah Bogor
            const now = new Date();
            const month = now.getMonth();
            
            // Jadwal perkiraan berdasarkan bulan
            if (month >= 2 && month <= 4) { // Maret-Mei (musim kemarau)
                prayerTimesData = {
                    "Subuh": "04:30",
                    "Syuruq": "05:45",
                    "Dzuhur": "11:55",
                    "Ashar": "15:15",
                    "Maghrib": "17:55",
                    "Isya": "19:05"
                };
            } else if (month >= 5 && month <= 7) { // Juni-Agustus
                prayerTimesData = {
                    "Subuh": "04:35",
                    "Syuruq": "05:50",
                    "Dzuhur": "11:50",
                    "Ashar": "15:10",
                    "Maghrib": "17:50",
                    "Isya": "19:00"
                };
            } else {
                prayerTimesData = {
                    "Subuh": "04:25",
                    "Syuruq": "05:40",
                    "Dzuhur": "11:45",
                    "Ashar": "15:05",
                    "Maghrib": "17:45",
                    "Isya": "18:55"
                };
            }
            
            updatePrayerScheduleUI();
            return false;
        }
        
        function updatePrayerScheduleUI() {
            const prayerGrid = document.getElementById('prayer-grid');
            const prayerItems = prayerGrid.querySelectorAll('.prayer-item');
            
            prayerOrder.forEach((prayerName, index) => {
                const prayerTime = prayerTimesData[prayerName] || "--:--";
                if (prayerItems[index]) {
                    const timeElement = prayerItems[index].querySelector('.prayer-time');
                    if (timeElement) {
                        timeElement.textContent = prayerTime;
                    }
                }
            });
        }
        
        async function refreshApiData() {
            const now = Date.now();
            if (now - lastApiFetch > API_CACHE_TIME) {
                console.log("ðŸ”„ Auto-refresh data API");
                await fetchPrayerTimes();
                await fetchHijriDate();
                await fetchAllData();
            }
        }
        
        // ========================================
        // CLOCK & COUNTDOWN
        // ========================================
        
        function updateDateTime() {
            const now = new Date();
            
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            
            const colon = now.getSeconds() % 2 === 0 ? ":" : " ";
            document.getElementById('digital-clock').innerHTML = 
                `${hours}<span class="blink">${colon}</span>${minutes}`;
            
            document.getElementById('salah-clock').textContent = `${hours}:${minutes}`;
            
            updateCountdown(now);
            updateActivePrayer(now);
        }
        
        function updateCountdown(now) {
            if (!prayerTimesData.Subuh) return;
            
            const currentTime = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();
            
            let nextPrayerName = "Subuh";
            let nextPrayerTime = prayerTimesData["Subuh"];
            let found = false;
            
            for (let i = 0; i < prayerOrder.length; i++) {
                const prayerName = prayerOrder[i];
                const prayerTime = prayerTimesData[prayerName];
                
                if (!prayerTime) continue;
                
                const [prayerHour, prayerMinute] = prayerTime.split(':').map(Number);
                const prayerSeconds = prayerHour * 3600 + prayerMinute * 60;
                
                if (prayerSeconds > currentTime) {
                    nextPrayerName = prayerName;
                    nextPrayerTime = prayerTime;
                    found = true;
                    break;
                }
            }
            
            if (!found) {
                nextPrayerName = "Subuh";
                nextPrayerTime = prayerTimesData["Subuh"];
            }
            
            const [nextHour, nextMinute] = nextPrayerTime.split(':').map(Number);
            const nextPrayerSeconds = nextHour * 3600 + nextMinute * 60;
            
            let diffSeconds = nextPrayerSeconds - currentTime;
            if (diffSeconds < 0) diffSeconds += 24 * 3600;
            
            const hours = Math.floor(diffSeconds / 3600);
            const minutes = Math.floor((diffSeconds % 3600) / 60);
            const seconds = diffSeconds % 60;
            
            document.getElementById('next-prayer-name').textContent = nextPrayerName;
            document.getElementById('countdown-timer').textContent = 
                `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
            
            if (hours === 0 && minutes < 5) {
                document.getElementById('countdown-timer').style.color = '#FFD700';
            } else {
                document.getElementById('countdown-timer').style.color = 'var(--text-light)';
            }
        }
        
        function updateActivePrayer(now) {
            if (currentMode === "friday") return;
            if (!prayerTimesData.Subuh) return;
            
            const currentTime = now.getHours() * 60 + now.getMinutes();
            const prayerItems = document.querySelectorAll('.prayer-item');
            
            prayerItems.forEach(item => item.classList.remove('active'));
            
            for (let i = 0; i < prayerOrder.length; i++) {
                const prayerName = prayerOrder[i];
                const prayerTime = prayerTimesData[prayerName];
                
                if (!prayerTime) continue;
                
                const [prayerHour, prayerMinute] = prayerTime.split(':').map(Number);
                const prayerTotalMinutes = prayerHour * 60 + prayerMinute;
                
                if (i > 0) {
                    const prevPrayerName = prayerOrder[i - 1];
                    const prevPrayerTime = prayerTimesData[prevPrayerName];
                    
                    if (!prevPrayerTime) continue;
                    
                    const [prevHour, prevMinute] = prevPrayerTime.split(':').map(Number);
                    const prevTotalMinutes = prevHour * 60 + prevMinute;
                    
                    if (currentTime >= prevTotalMinutes && currentTime < prayerTotalMinutes) {
                        if (prayerItems[i]) {
                            prayerItems[i].classList.add('active');
                        }
                        break;
                    }
                }
            }
        }
        
        // ========================================
        // WISDOM ROTATION
        // ========================================
        
        function initDailyContent() {
            const now = new Date();
            const dayOfWeek = now.getDay();
            
            const dayMap = {
                0: 'sunday', 1: 'monday', 2: 'tuesday', 3: 'wednesday',
                4: 'thursday', 5: 'friday', 6: 'saturday'
            };
            
            const todayWisdoms = wisdomsData.filter(w => w.day === dayMap[dayOfWeek]);
            
            if (todayWisdoms.length > 0) {
                wisdomIndex = 0;
                updateWisdomContent(todayWisdoms);
            } else {
                document.getElementById('wisdom-text').textContent = 'Selamat datang di Masjid Baiturrahman STMIK Tazkia';
                document.getElementById('wisdom-reference').textContent = 'QS. Al-Jumu\'ah (62) : 9-10';
            }
        }
        
        function rotateWisdom() {
            if (currentMode === "friday") {
                rotateFridayWisdom();
                return;
            }
            
            const now = new Date();
            const dayOfWeek = now.getDay();
            const dayMap = {
                0: 'sunday', 1: 'monday', 2: 'tuesday', 3: 'wednesday',
                4: 'thursday', 5: 'friday', 6: 'saturday'
            };
            
            const todayWisdoms = wisdomsData.filter(w => w.day === dayMap[dayOfWeek]);
            
            if (todayWisdoms.length === 0) return;
            
            const wisdomContent = document.getElementById('wisdom-content');
            wisdomContent.style.opacity = 0;
            
            setTimeout(() => {
                wisdomIndex = (wisdomIndex + 1) % todayWisdoms.length;
                updateWisdomContent(todayWisdoms);
                
                setTimeout(() => {
                    wisdomContent.style.opacity = 1;
                }, 50);
            }, 400);
        }
        
        function updateWisdomContent(wisdoms) {
            if (wisdoms.length === 0) return;
            
            const wisdom = wisdoms[wisdomIndex];
            document.getElementById('wisdom-text').textContent = wisdom.text;
            document.getElementById('wisdom-reference').textContent = wisdom.reference;
        }
        
        function rotateFridayWisdom() {
            if (fridayWisdomsData.length === 0) return;
            
            const wisdomContent = document.getElementById('wisdom-content');
            wisdomContent.style.opacity = 0;
            
            setTimeout(() => {
                fridayHadithIndex = (fridayHadithIndex + 1) % fridayWisdomsData.length;
                const hadith = fridayWisdomsData[fridayHadithIndex];
                
                document.getElementById('wisdom-text').textContent = hadith.text;
                document.getElementById('wisdom-reference').textContent = hadith.reference;
                
                setTimeout(() => {
                    wisdomContent.style.opacity = 1;
                }, 50);
            }, 400);
        }
        
        // ========================================
        // WALLPAPER & ANNOUNCEMENT ROTATION
        // ========================================
        
        function rotateWallpaper() {
            if (currentMode === "friday") return;
            
            const wallpapers = document.querySelectorAll('.wallpaper-slide');
            if (wallpapers.length === 0) return;
            
            wallpapers.forEach(wallpaper => wallpaper.classList.remove('active'));
            
            wallpaperIndex = (wallpaperIndex + 1) % wallpapers.length;
            wallpapers[wallpaperIndex].classList.add('active');
        }
        
        function rotateAnnouncement() {
            if (currentMode !== "friday") return;
            
            const slides = document.querySelectorAll('.announcement-slide');
            if (slides.length === 0) return;
            
            slides.forEach(slide => slide.classList.remove('active'));
            
            announcementIndex = (announcementIndex + 1) % slides.length;
            slides[announcementIndex].classList.add('active');
        }
        
        // ========================================
        // FRIDAY MODE
        // ========================================
        
        function checkFridayMode() {
            const now = new Date();
            const dayOfWeek = now.getDay();
            const currentHour = now.getHours();
            const currentMinute = now.getMinutes();
            const currentSeconds = now.getSeconds();
            
            const fridayStartHour = configData.friday_start_hour || 8;
            const fridayEndHour = configData.friday_end_hour || 14;
            const countdownSeconds = configData.friday_countdown || 60;
            
            if (dayOfWeek === 5) { // Friday
                const isFridayTime = (currentHour >= fridayStartHour && currentHour < fridayEndHour);
                const isCountdownTime = (currentHour === (fridayStartHour - 1) && currentMinute >= 59);
                
                if (isCountdownTime) {
                    showFridayCountdown(countdownSeconds - currentSeconds);
                } else if (isFridayTime) {
                    activateFridayMode();
                } else {
                    deactivateFridayMode();
                }
            } else {
                deactivateFridayMode();
            }
        }
        
        function showFridayCountdown(secondsLeft) {
            const countdownEl = document.getElementById('friday-countdown');
            const countdownTimerEl = document.getElementById('friday-mode-countdown');
            
            const minutes = Math.floor(secondsLeft / 60);
            const seconds = secondsLeft % 60;
            countdownTimerEl.textContent = `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
            
            countdownEl.classList.add('show');
            
            if (secondsLeft <= 0) {
                countdownEl.classList.remove('show');
                activateFridayMode();
            }
        }
        
        function activateFridayMode() {
            if (currentMode === "friday") return;
            
            currentMode = "friday";
            document.body.classList.add('friday-mode');
            document.getElementById('friday-notification').classList.add('show');
            
            fridayHadithIndex = 0;
            if (fridayWisdomsData.length > 0) {
                const hadith = fridayWisdomsData[fridayHadithIndex];
                document.getElementById('wisdom-text').textContent = hadith.text;
                document.getElementById('wisdom-reference').textContent = hadith.reference;
            }
            
            createAdabMarquee();
            announcementIndex = 0;
        }
        
        function deactivateFridayMode() {
            if (currentMode !== "friday") return;
            
            currentMode = "normal";
            document.body.classList.remove('friday-mode');
            document.getElementById('friday-notification').classList.remove('show');
            document.getElementById('friday-countdown').classList.remove('show');
            
            initDailyContent();
            createAdabMarquee();
        }
        
        // ========================================
        // AZAN & SALAH MODE
        // ========================================
        
        function checkAzanMode() {
            if (currentMode === "friday") {
                const now = new Date();
                const currentHour = now.getHours();
                const fridayStartHour = configData.friday_start_hour || 8;
                const fridayEndHour = configData.friday_end_hour || 14;
                if (currentHour >= fridayStartHour && currentHour < fridayEndHour) return;
            }
            
            if (!prayerTimesData.Subuh) return;
            
            const now = new Date();
            const currentTime = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();
            
            const azanCountdown = configData.azan_countdown || 30;
            const iqamahCountdown = configData.iqamah_countdown || 180;
            const salahDuration = configData.salah_duration || 420;
            
            for (const prayerName of prayerOrder) {
                const prayerTime = prayerTimesData[prayerName];
                if (!prayerTime) continue;
                
                const [prayerHour, prayerMinute] = prayerTime.split(':').map(Number);
                const prayerSeconds = prayerHour * 3600 + prayerMinute * 60;
                
                // Phase 1: Countdown before Azan
                if (currentTime >= prayerSeconds - azanCountdown && currentTime < prayerSeconds) {
                    if (currentMode !== "azan" || currentPrayerName !== prayerName) {
                        activateAzanMode(prayerName, prayerSeconds - currentTime, 1);
                    }
                    return;
                }
                
                // Phase 2: Countdown to Iqamah
                if (currentTime >= prayerSeconds && currentTime < prayerSeconds + iqamahCountdown) {
                    if (currentMode !== "azan" || currentPrayerName !== prayerName) {
                        activateAzanMode(prayerName, prayerSeconds + iqamahCountdown - currentTime, 2);
                    }
                    return;
                }
                
                // Phase 3: Salah Mode
                if (currentTime >= prayerSeconds + iqamahCountdown && currentTime < prayerSeconds + iqamahCountdown + salahDuration) {
                    if (currentMode !== "salah") {
                        activateSalahMode(prayerName);
                    }
                    return;
                }
            }
            
            if ((currentMode === "azan" || currentMode === "salah") && !isInAzanTimeRange(now)) {
                deactivateAzanMode();
            }
        }
        
        function isInAzanTimeRange(now) {
            const currentTime = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();
            const azanCountdown = configData.azan_countdown || 30;
            const iqamahCountdown = configData.iqamah_countdown || 180;
            const salahDuration = configData.salah_duration || 420;
            
            for (const prayerName of prayerOrder) {
                const prayerTime = prayerTimesData[prayerName];
                if (!prayerTime) continue;
                
                const [prayerHour, prayerMinute] = prayerTime.split(':').map(Number);
                const prayerSeconds = prayerHour * 3600 + prayerMinute * 60;
                
                if ((currentTime >= prayerSeconds - azanCountdown && currentTime < prayerSeconds) ||
                    (currentTime >= prayerSeconds && currentTime < prayerSeconds + iqamahCountdown) ||
                    (currentTime >= prayerSeconds + iqamahCountdown && currentTime < prayerSeconds + iqamahCountdown + salahDuration)) {
                    return true;
                }
            }
            
            return false;
        }
        
        function activateAzanMode(prayerName, timeLeft, phase) {
            currentMode = "azan";
            azanPhase = phase;
            currentPrayerName = prayerName;
            
            const azanOverlay = document.getElementById('azan-overlay');
            const azanTitle = document.getElementById('azan-title');
            const azanCountdown = document.getElementById('azan-countdown');
            const azanPrayerName = document.getElementById('azan-prayer-name');
            
            azanTitle.textContent = phase === 1 ? "DETIK MENUJU AZAN" : "MENUJU IQAMAH";
            azanPrayerName.textContent = prayerName.toUpperCase();
            
            if (phase === 1) {
                azanCountdown.textContent = timeLeft;
            } else {
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                azanCountdown.textContent = `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
            }
            
            azanOverlay.classList.add('show');
            
            if (phase === 1 && audioContext && beepSound) {
                playBeepSound();
                azanTimer = setInterval(playBeepSound, 1000);
            }
            
            if (phase === 2 && timeLeft <= 10 && audioContext && beepSound) {
                playBeepSound();
                iqamahTimer = setInterval(playBeepSound, 1000);
            }
            
            const updateTimer = setInterval(() => {
                timeLeft--;
                
                if (phase === 1) {
                    azanCountdown.textContent = timeLeft;
                    
                    if (timeLeft <= 0) {
                        clearInterval(updateTimer);
                        if (azanTimer) clearInterval(azanTimer);
                        const iqamahCountdown = configData.iqamah_countdown || 180;
                        activateAzanMode(prayerName, iqamahCountdown, 2);
                    }
                } else {
                    const minutes = Math.floor(timeLeft / 60);
                    const seconds = timeLeft % 60;
                    azanCountdown.textContent = `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
                    
                    if (timeLeft <= 10 && !iqamahTimer && audioContext && beepSound) {
                        playBeepSound();
                        iqamahTimer = setInterval(playBeepSound, 1000);
                    }
                    
                    if (timeLeft <= 0) {
                        clearInterval(updateTimer);
                        if (iqamahTimer) clearInterval(iqamahTimer);
                        activateSalahMode(prayerName);
                    }
                }
            }, 1000);
            
            window.azanUpdateTimer = updateTimer;
        }
        
        function activateSalahMode(prayerName) {
            currentMode = "salah";
            document.getElementById('azan-overlay').classList.remove('show');
            document.getElementById('salah-text').textContent = `Shalat ${prayerName.toUpperCase()}...`;
            document.getElementById('salah-overlay').classList.add('show');
            
            const salahDuration = configData.salah_duration || 420;
            
            salahTimer = setTimeout(() => {
                deactivateAzanMode();
            }, salahDuration * 1000);
        }
        
        function deactivateAzanMode() {
            currentMode = "normal";
            
            if (azanTimer) clearInterval(azanTimer);
            if (iqamahTimer) clearInterval(iqamahTimer);
            if (window.azanUpdateTimer) clearInterval(window.azanUpdateTimer);
            if (salahTimer) clearTimeout(salahTimer);
            
            document.getElementById('azan-overlay').classList.remove('show');
            document.getElementById('salah-overlay').classList.remove('show');
            
            azanTimer = null;
            iqamahTimer = null;
            window.azanUpdateTimer = null;
            salahTimer = null;
            currentPrayerName = "";
        }
        
        // ========================================
        // AUDIO
        // ========================================
        
        function initAudio() {
            try {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
                beepSound = {
                    play: function() {
                        const oscillator = audioContext.createOscillator();
                        const gainNode = audioContext.createGain();
                        
                        oscillator.connect(gainNode);
                        gainNode.connect(audioContext.destination);
                        
                        oscillator.frequency.value = 800;
                        oscillator.type = 'sine';
                        
                        gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);
                        
                        oscillator.start(audioContext.currentTime);
                        oscillator.stop(audioContext.currentTime + 0.1);
                    }
                };
            } catch (error) {
                console.error("Audio tidak didukung:", error);
            }
        }
        
        function playBeepSound() {
            if (beepSound) {
                beepSound.play();
            }
        }
        
        // ========================================
        // FULLSCREEN
        // ========================================
        
        function enterFullscreen() {
            const elem = document.documentElement;
            if (elem.requestFullscreen) elem.requestFullscreen();
            else if (elem.mozRequestFullScreen) elem.mozRequestFullScreen();
            else if (elem.webkitRequestFullscreen) elem.webkitRequestFullscreen();
            else if (elem.msRequestFullscreen) elem.msRequestFullscreen();
        }
        
        document.addEventListener('fullscreenchange', handleFullscreenChange);
        document.addEventListener('webkitfullscreenchange', handleFullscreenChange);
        document.addEventListener('mozfullscreenchange', handleFullscreenChange);
        document.addEventListener('MSFullscreenChange', handleFullscreenChange);
        
        function handleFullscreenChange() {
            if (!document.fullscreenElement && 
                !document.webkitFullscreenElement && 
                !document.mozFullScreenElement && 
                !document.msFullscreenElement) {
                document.getElementById('fullscreen-overlay').style.display = 'flex';
            }
        }
        
        // ========================================
        // INITIALIZATION
        // ========================================
        
        document.addEventListener('DOMContentLoaded', async function() {
            console.log("ðŸš€ Starting Display Digital Masjid...");
            
            // Fetch all data from API
            await fetchAllData();
            
            // Fetch Hijri date
            await fetchHijriDate();
            
            // Fetch prayer times
            await fetchPrayerTimes();
            
            // Init audio
            initAudio();
            
            // Init daily content
            initDailyContent();
            
            // Create adab marquee
            createAdabMarquee();
            
            // Update datetime immediately
            updateDateTime();
            
            // Setup fullscreen
            setTimeout(() => {
                if (!document.fullscreenElement) {
                    document.getElementById('fullscreen-overlay').style.display = 'flex';
                }
            }, 2000);
            
            document.getElementById('enter-fullscreen-btn').addEventListener('click', function() {
                enterFullscreen();
                document.getElementById('fullscreen-overlay').style.display = 'none';
            });
            
            document.addEventListener('click', function firstClick() {
                if (!document.fullscreenElement) {
                    enterFullscreen();
                    document.getElementById('fullscreen-overlay').style.display = 'none';
                }
                document.removeEventListener('click', firstClick);
            });
            
            // Refresh Hijri date every hour
            setInterval(fetchHijriDate, 3600000);
            
            // Start intervals
            setInterval(updateDateTime, 1000);
            setInterval(rotateWisdom, (configData.wisdom_duration || 60) * 1000);
            setInterval(rotateWallpaper, (configData.wallpaper_duration || 30) * 1000);
            setInterval(rotateAnnouncement, (configData.announcement_duration || 30) * 1000);
            setInterval(checkFridayMode, 60000);
            setInterval(checkAzanMode, 1000);
            setInterval(refreshApiData, 3600000); // 1 hour
            
            console.log("âœ… Display initialized successfully!");
        });
    </script>
</body>
</html>
